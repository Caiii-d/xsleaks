<head>
  <title>Response size leak</title>
  <script>
    
    async function get_diff(url, status) {
      let start = performance.getEntries().length;
      let sound = document.createElement('audio');
      sound.src = `${url}?status=${status}`;

      return new Promise((resolve) => {
        sound.onerror = () => {
          let entries = performance.getEntries();
          let end = entries.length;
          //console.log(entries);
          return resolve(`${end - start}`);
        }
      });

    }

    async function run(url) {
      for (let i = 100; i < 600; i++) {
        document.body.innerHTML += `${i} ${await get_diff(url, i)}<br>`;
      }
    }
    
    onload = () => {
      run('http://ibgang.com:8880');
    }
  </script>
</head>

<body>
</body>

</html>
